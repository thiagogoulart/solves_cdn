function SolvesGeo(){this.solvesPluginName="SolvesGeo",this.versionId=2,this.version="1.1",this.addressData=null,this.geoData=null,this.gotUserPosition=!1,this.lat=null,this.long=null,this.emailOrigin=null,this.STORAGE_KEY_LATITUDE="SOLVES_GEO_LAST_LATITUDE",this.STORAGE_KEY_LONGITUDE="SOLVES_GEO_LAST_LONGITUDE",this.init=function(){$.Solves.addSolvesPlugin(this.solvesPluginName,$.SolvesGeo)},this.afterSolvesInit=function(){let t=$.Solves.getSolvesPlugin("SolvesStorage");null!=t?(this.lat=t.getCache(this.STORAGE_KEY_LATITUDE),this.long=t.getCache(this.STORAGE_KEY_LONGITUDE),this.geoData=t.getStorageGeoData(),this.addressData=t.getStorageAddressData()):console.log(this.solvesPluginName+" não encontrou SolvesStorage")},this.destroy=function(){let t=$.Solves.getSolvesPlugin("SolvesStorage");null!=t?(t.clearGeoData(),t.clearCache(this.STORAGE_KEY_LATITUDE),t.clearCache(this.STORAGE_KEY_LONGITUDE)):console.log(this.solvesPluginName+" não encontrou SolvesStorage")},this.setEmailOrigin=function(t){this.emailOrigin=t},this.getGpsLocation=function(t,s,e){if(!this.gotUserPosition||t){navigator&&navigator.geolocation&&navigator.geolocation.getCurrentPosition(function(o){t.setUserPosition(o,s,e)},function(){e()});let t=this}},this.setUserPosition=function(t,s,e){this.gotUserPosition=!0,this.lat=t.coords.latitude,this.long=t.coords.longitude,this.storeLastPosition(this.lat,this.long),this.getGpsDetails(s,e)},this.getGpsDetails=function(t,s,e){let o=this;$.getJSON("https://nominatim.openstreetmap.org/reverse?format=jsonv2&lat="+this.lat+"&lon="+this.long+"&polygon_svg=1&addressdetails=1",function(data){o.setGeoData(data),t&&"function"==typeof t&&t(data)}).fail(function(){s&&"function"==typeof s&&s()}).always(function(){e&&"function"==typeof e&&e()})},this.setAddressDataByGeoData=function(t,s){let e=this.geoData.address.postcode,o=this.geoData.address.country,i=this.geoData.address.country_code,a=this.geoData.address.state,n=this.geoData.address.state_district,l=this.geoData.address.city,r=this.geoData.address.city_district,d=this.geoData.address.county,g=this.geoData.address.neighbourhood,h=this.geoData.address.suburb,u=this.geoData.address.road;$.Solves.isNotEmpty(u)||(u=this.geoData.address.footway);let c=this.geoData.address.university,S=this.geoData.lat,D=this.geoData.lon,v=this.geoData.name,_=this.geoData.display_name,f=this.geoData.place_id,E=this.geoData.type,G=this.geoData.osm_id,m=this.geoData.osm_type;this.addressData={cep:e,country:o,country_code:i,uf_id:void 0,uf:a,uf_distrito:n,cidade_id:void 0,cidade_distrito:r,cidade_microregiao:d,cidade:l,bairro:g,suburb:h,logradouro:u,universidade:c,numero:t,complemento:s,latitude:S,longitude:D,name:v,display_name:_,place_id:f,type:E,osm_id:G,osm_type:m},this.storeAddressData()},this.setAddressData=function(t,s,e,o,i,a,n,l){this.addressData={cep:t,uf_id:s,uf:e,cidade_id:o,cidade:i,logradouro:a,numero:n,complemento:l},this.storeAddressData()},this.setGeoData=function(t){this.geoData=t,this.storeGeoData()},this.storeAddressData=function(){let t=$.Solves.getSolvesPlugin("SolvesStorage");null!=t?t.setStorageAddressData(this.addressData):console.log(this.solvesPluginName+" não encontrou SolvesStorage")},this.storeGeoData=function(){let t=$.Solves.getSolvesPlugin("SolvesStorage");null!=t?t.setStorageGeoData(this.geoData):console.log(this.solvesPluginName+" não encontrou SolvesStorage")},this.storeLastPosition=function(t,s){let e=$.Solves.getSolvesPlugin("SolvesStorage");null!=e?(e.setCache(this.STORAGE_KEY_LATITUDE,t,!1),e.setCache(this.STORAGE_KEY_LONGITUDE,s,!1)):console.log(this.solvesPluginName+" não encontrou SolvesStorage")}}$.SolvesGeo=new SolvesGeo,$.SolvesGeo.init();