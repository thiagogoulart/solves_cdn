function SolvesVideo(){this.solvesPluginName="SolvesVideo",this.versionId=1,this.version="1.0",this.urlPublicVideos=null,this.urlVideos=null,this.urlCanais=null,this.youtubeApiKey=null,this.youtubeChannelUrl=null,this.youtubePlayer=null,this.youtubeRestUrlSearchChannel=null,this.videoDone=!1,this.videoPause=!1,this.initialSecondsToWatch=45,this.secondsToWatch=45,this.timeoutContagemWatch=null,this.loggedInToWatchNextVideo=!0,this.selectFieldClass="select_youtube_videos",this.containerWatchPlayerElmId="watch_player",this.containerWatchPlayerDescElmId="watch_player_desc",this.containerWatchChannelDescElmId="watch_channel_desc",this.containerWatchChannelDescNameElmId="watch_channel_desc_name",this.containerWatchCounterElmId="watch_counter",this.containerWatchCounterNumberElmId="watch_counter_number",this.containerWatchCounterSecsElmId="watch_counter_secs",this.containerWatchNextElmId="watch_next",this.PARAM_NAME_VIDEOS="videos",this.init=function(){$.Solves.addSolvesPlugin(this.solvesPluginName,$.SolvesVideo)},this.destroy=function(){},this.setYoutubeApiKey=function(e){this.youtubeApiKey=e},this.setInitialSecondsToWatch=function(e){this.initialSecondsToWatch=e,this.secondsToWatch=this.initialSecondsToWatch},this.restartSecondsToWatch=function(){this.secondsToWatch=this.initialSecondsToWatch},this.getYoutubeUrlApiDados=function(){return $.Solves.isNotEmpty(this.youtubeApiKey)?"https://www.googleapis.com/youtube/v3/channels?part=snippet&maxResults=1&key="+this.youtubeApiKey+"&":null},this.getYoutubeUrlApiDadosQuery=function(){return $.Solves.isNotEmpty(this.youtubeApiKey)?"https://www.googleapis.com/youtube/v3/search?part=snippet&type=channel&maxResults=1&key="+this.youtubeApiKey+"&":null},this.youtubeUrlApiEstatisticas=function(){return $.Solves.isNotEmpty(this.youtubeApiKey)?"https://www.googleapis.com/youtube/v3/channels?part=statistics&key="+this.youtubeApiKey+"&":null},this.getUrlPublicVideos=function(e){return this.urlPublicVideos+"?url="+e},this.getUrlVideos=function(e){return this.urlVideos+"?url="+e},this.showModalPublicWatchVideo=function(e,t){this.youtubePlayer=void 0;var o=$.Solves.getSolvesPlugin("SolvesUi");null!=o?(o.showModalSmall(e,'<div id="modal_player_container" class="modal_player_container">CARREGANDO VÍDEO...</div>','<a href="javascript:$.SolveUi.closeModalSmall();">Fechar</a>'),this.onYouTubeIframeAPIReady("modal_player_container",t)):console.log(this.solvesPluginName+" não encontrou SolvesUi")},this.listPublicWatchVideo=function(e){var t=$.Solves.getSolvesPlugin("SolvesStorage");if(null!=t){var o=t.getCache(this.PARAM_NAME_VIDEOS)[0];$("#"+e).html("");for(var a in o){var i=o[a];this.appendHtmlItemListPublicWatchVideo(e,a,i)}o=null}else console.log(this.solvesPluginName+" não encontrou SolvesStorage")},this.appendHtmlItemListPublicWatchVideo=function(e,t,o){var a=this.getUrlPublicVideos(o.url);$("#"+e).prepend('<div class="col-lg-3 col-md-3 col-sm-3 col-xl-3 col-6 bg-white mg-b-10 list_'+e+'" id="v_'+t+'" data-qtd_list="'+e+'" data-item_list="'+t+'"><div class="thumb-img" align="center"><a target="_blank" rel="noopener" href="javascript:$.SolvesVideo.createContainerPublicWatchVideo('+t+');" alt="'+o.nome+'" title="'+o.nome+'"><img src="'+o.avatar+'" style="width: 100%;" class="img-responsive" title="'+o.nome+'" /></a></div><div class="caption" style="padding:4px">                            <a class="text-danger" href="'+a+'" alt="Ver detalhes do vídeo" title="Ver detalhes do vídeo"><b style="font-size: 12px;">'+o.nome+'</b></a><div><i class="fa fa-tag"></i> <!--a href="/?cat='+o.categoria_video_id+'" alt="Ver detalhes da Categoria" title="Ver detalhes da Categoria"-->'+o.categoria_video_id_label+"<!--/a--></div></div></div>")},this.getHtmlVideoDesc=function(e){var t=this.getUrlVideos(e.url);return'<h4 style="text-align: center;"><strong>VÍDEO: </strong> <a href="'+t+'"  style="text-align: center;" alt="Ver detalhes do Vídeo" title="Ver detalhes do Vídeo">'+e.nome+"</a></h4><div>"+e.description+"</div>"},this.getPublicHtmlVideoDesc=function(e){var t=this.getUrlPublicVideos(e.url);return'<h4 style="text-align: center;"><strong>VÍDEO: </strong> <a href="'+t+'"  style="text-align: center;" alt="Ver detalhes do Vídeo" title="Ver detalhes do Vídeo">'+e.nome+"</a></h4><div>"+e.description+"</div>"},this.createContainerPublicWatchVideo=function(e){var t=$.Solves.getSolvesPlugin("SolvesStorage");if(null!=t){$.Solves.objeto=t.getCache(this.PARAM_NAME_VIDEOS)[0][e],$("#"+elmContainerId).html("");for(var o in lista){var a=lista[o];this.appendHtmlItemListPublicWatchVideo(elmContainerId,o,a)}lista=null}else console.log(this.solvesPluginName+" não encontrou SolvesStorage");this.youtubePlayer=void 0,$("#v_"+e+"_player_container").remove(),$(".player_container").remove();$("#v_"+e).attr("data-qtd_list"),$("#v_"+e).attr("data-item_list");$("#v_"+e).after('<div class="player_container col-12 mt-2 mb-3" id="v_'+e+'_player_container"><div class="card overflow-hidden"><div class="card-body pd-0 bd-color-gray-lighter"><center><div class="row" style="padding: 8px; background: rgb(85, 85, 85); color: #FFFFFF;"><div class="col-lg-6 col-md-6 col-sm-12 col-xl-12" style="text-align:left;"><div><strong>CANAL: </strong><span id="watch_channel_desc_name"></span></div></div><div class="col-lg-6 col-md-6 col-sm-12 col-xl-12" style="text-align:right"><div id="watch_channel_desc">'+this.getSubscribeButton($.Solves.objeto.channel_id_url,!0)+'</div></div></div><div id="watch_player">CARREGANDO VÍDEO...<!-- VIDEO WILL BE EMBEDED HERE--></div><div id="watch_player_desc" style="padding: 8px;background: rgb(192, 192, 192); color:#000000;">'+this.getPublicHtmlVideoDesc($.Solves.objeto)+"</div></center></div><!-- card-body -->              </div><!-- card --></div>").focus(),this.onYouTubeIframeAPIReady("watch_player",$.Solves.objeto.url)},this.contagem_tempo=function(e,t,o,a){if(0==this.secondsToWatch)this.restartSecondsToWatch(),$("#"+a).hide(),$("#"+e).html(0),$("#"+t).html("segundo"),this.unblockNextButtonVideo(o);else{if(!this.videoPause){$("#"+a).show(),this.blockNextButtonVideo(o),$("#"+e).html(this.secondsToWatch),$("#"+t).html("segundo"+(this.secondsToWatch>1?"s":""));var i=this.secondsToWatch==this.initialSecondsToWatch?4e3:1e3;this.secondsToWatch=this.secondsToWatch-1}this.timeoutContagemWatch=setTimeout("$.SolvesVideo.contagem_tempo('"+e+"', '"+t+"', '"+o+"', '"+a+"')",i)}},this.blockNextButtonVideo=function(e){$("#"+e).removeClass("btn-success").addClass("btn-dark").attr("aria-disabled","true").attr("disabled","true").addClass("disabled").attr("href","return false")},this.unblockNextButtonVideo=function(e){$("#"+e).removeClass("btn-dark").addClass("btn-success").removeAttr("aria-disabled").removeAttr("disabled").removeClass("disabled").attr("href","javascript:$.SolvesVideo.watchNextVideo()")},this.watchNextVideo=function(){if(!this.loggedInToWatchNextVideo||$.Solves.isLogado())this.doAjaxVideoFindToWatch(this.containerWatchPlayerElmId,this.containerWatchPlayerDescElmId,this.containerWatchChannelDescElmId,this.containerWatchChannelDescNameElmId);else{this.stopAndClosePlayer();var e=$.Solves.getSolvesPlugin("SolvesUi");null!=e&&e.closeModalSmall()}},this.likeVideo=function(e){$.ajax({type:"POST",url:"https://www.googleapis.com/youtube/v3/videos/rate",processData:!1,contentType:!1,cache:!1,data:{id:e,rating:"like"},success:function(e){console.log(e)},error:function(e){console.log(e)}})},this.getSubscribeButton=function(e,t){return'<script src="https://apis.google.com/js/platform.js"></script><div class="g-ytsubscribe" data-channelid="'+e+'" '+(t?'data-layout="full"':"")+' data-theme="dark" data-count="default"></div>'},this.stopAndClosePlayer=function(){void 0!=this.youtubePlayer&&null!=this.youtubePlayer&&(this.youtubePlayer.stopVideo(),this.youtubePlayer.clearVideo())},this.getPlayerDuration=function(){return void 0!==this.youtubePlayer&&null!=this.youtubePlayer?Math.round(this.youtubePlayer.getDuration()):0},this.showNoVideoPlayer=function(e,t,o){this.blockNextButtonVideo("watch_next");var a="<h2>Aguarde novos vídeos!</h2>Parece que todos os vídeos foram assistidos conforme a quantidade de pontos.";$("#"+e+"_msg").length>0&&$("#"+e+"_msg").remove(),$("#"+e).hide(),$("#"+o).hide(),$('<div id="'+e+'_msg" class="mg-b-50 mg-t-50">'+a+"</div>").insertAfter("#"+e)},this.onYouTubeIframeAPIReady=function(e,t){if(0!=$("#"+e).length)if($.Atual.videoDone=!1,void 0==this.youtubePlayer||null==this.youtubePlayer){var o=320;void 0!==window.innerWidth&&null!=window.innerWidth&&(o=window.innerWidth,o-=o>992?418:40,o>711&&(o=711));var a=56.25*o/100;this.youtubePlayer=new YT.Player(e,{height:a,width:o,videoId:t,events:{onReady:onPlayerReady,onStateChange:onPlayerStateChange}})}else this.youtubePlayer.loadVideoById({videoId:t,startSeconds:0}),startContadorTempoMinimoVideo()},this.onPlayerReady=function(e){e.target.playVideo(),this.startContadorTempoMinimoVideo()},this.startContadorTempoMinimoVideo=function(){this.loggedInToWatchNextVideo&&!$.Solves.isLogado()||(this.restartSecondsToWatch(),this.contagem_tempo(this.containerWatchCounterNumberElmId,this.containerWatchCounterSecsElmId,this.containerWatchNextElmId,this.containerWatchCounterElmId))},this.onPlayerStateChange=function(){this.youtubePlayer.getPlayerState()==YT.PlayerState.ENDED?this.watchNextVideo():this.youtubePlayer.getPlayerState()==YT.PlayerState.PLAYING?(this.videoPause=!1,$.Solves.loaded(),0==this.secondsToWatch&&this.restartSecondsToWatch()):this.youtubePlayer.getPlayerState()==YT.PlayerState.UNSTARTED&&0==getPlayerDuration()?(this.videoPause=!1,this.secondsToWatch=0):this.videoPause=!0},this.stopVideo=function(){this.youtubePlayer.stopVideo()},this.getVideoIdYoutubeByUrl=function(e){return e=$.Solves.removeEspacos(e),e=e.replace("https://www.youtube.com/watch?v=",""),e=e.replace("http://www.youtube.com/watch?v=",""),e=e.replace("http://m.youtube.com/watch?v=",""),e=e.replace("https://m.youtube.com/watch?v=",""),e=e.replace("https://youtu.be/",""),e=e.replace("http://youtu.be/",""),e=e.replace("https://www.youtube.com/","")},this.getChannelIdYoutubeByUrl=function(e){return e=$.Solves.removeEspacos(e),e=e.replace("https://www.youtube.com/channel/","")},this.getStatisticsYoutubeChannel=function(e){$.Solves.doAjaxExternal(URL_API_ESTATISTICAS+"id="+e,"GET",{id:e},function(e){result=jQuery.parseJSON(e)},function(){})},this.configSelect2Channels=function(e,t){this.selectFieldClass=t,$("."+this.selectFieldClass).length>0&&$("."+this.selectFieldClass).select2({language:"pt-BR",dropdownParent:$("#"+e),ajax:{type:"POST",processData:!1,contentType:!1,cache:!1,url:this.youtubeRestUrlSearchChannel,headers:{Authorization:""},data:function(e){return getFormData({term:e.term})},processResults:function(e){if(null!=e&&void 0!=e){result=jQuery.parseJSON(e);var t=[];if(void 0!==result)for(var o in result){var a=result[o];if(void 0!=a&&void 0!=a.id&&void 0!=a.nome){var i='<div class="list_item_canal_container"><div class="item_canal_image_container"><img class="item_canal_image img-responsive" src="'+a.avatar+'"></div><div class="item_canal_nome">'+a.nome+"</div></div>";t.push({id:a.id,text:a.nome,html:i,avatar:a.avatar,nome:a.nome})}}return{results:t}}},success:function(){},error:function(){}},placeholder:"Selecione seu canal no Youtube",minimumInputLength:3,templateResult:function(e){return $(e.html)},templateSelection:function(e){return e.nome||e.url}}).on("select2:select",function(e){var t=e.params.data,o="https://www.youtube.com/channel/"+t.id;$("#user_avatar").length>0&&$("#user_avatar").val(t.avatar),$("#user_avatar_prev").length>0&&$("#user_avatar_prev").attr("src",t.avatar),$("#channel_avatar").length>0&&$("#channel_avatar").val(t.avatar),$("#channel_avatar_prev").length>0&&$("#channel_avatar_prev").attr("src",t.avatar),$("#channel_nome").val(t.nome),$("#label_channel_nome").html(t.nome),$("#channel_url").val(o),$("#label_channel_url").html(o)})}}$.SolvesVideo=new SolvesVideo,$.SolvesVideo.init();